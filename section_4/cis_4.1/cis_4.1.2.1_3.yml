{{ if .Vars.ubuntu20cis_level_2 }}
  {{ if .Vars.ubuntu20cis_rule_4_1_2_1 }}
file:
  /etc/audit/auditd.conf:
    exists: true
    title: '4.1.2.1 | Ensure audit log storage size is configured
            4.1.2.2 | Ensure audit logs are not automatically deleted
            4.1.2.3 | Ensure system is disabled when audit logs are full'
    contains: 
    - '/max_log_file = /\d/'
    {{ if .Vars.ubuntu20cis_rule_4_1_2_2 }}
    - 'max_log_file_action = {{ .Vars.ubuntu20cis_auditd.max_log_file_action }}'
    {{ end }}
    {{ if .Vars.ubuntu20cis_rule_4_1_2_3 }}
    - space_left_action = {{ .Vars.ubuntu20cis_auditd.space_left_action }}
    - action_mail_acct = {{ .Vars.ubuntu20cis_auditd.action_mail_acct }}
    - '/^admin_space_left_action = {{ .Vars.ubuntu20cis_auditd.admin_space_left_action }}/'
    {{ end }}
    meta:
      server: 2
      workstation: 2
      CIS_ID: 
      - 4.1.2.1
      - 4.1.2.2
      - 4.1.2.3
  {{ end }}
{{ end }}
